syntax = "proto3";

package dnd5e;

service Dnd5eService {
  rpc GetEndpoints(GetEndpointsRequest) returns (GetEndpointsResponse);
  rpc GetList(GetListRequest) returns (GetListResponse);
  rpc GetItem(GetItemRequest) returns (GetItemResponse);
  rpc SearchItems(SearchItemsRequest) returns (SearchItemsResponse);
  rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
}

message GetEndpointsRequest {}

message GetEndpointsResponse {
  repeated string endpoints = 1;
  int32 total_count = 2;
}

message GetListRequest {
  string endpoint = 1;
  int32 page = 2;
  int32 page_size = 3;
}

message GetListResponse {
  string endpoint = 1;
  int32 total_count = 2;
  int32 page = 3;
  int32 page_size = 4;
  repeated ApiItem items = 5;
  bool has_more = 6;
}

message GetItemRequest {
  string endpoint = 1;
  string index = 2;
}

message GetItemResponse {
  ApiItem item = 1;
  string raw_data = 2;
}

message SearchItemsRequest {
  string query = 1;
  repeated string endpoints = 2;
  int32 max_results = 3;
}

message SearchItemsResponse {
  string query = 1;
  repeated SearchResult results = 2;
  int32 total_found = 3;
}

message HealthCheckRequest {}

message HealthCheckResponse {
  enum ServingStatus {
    UNKNOWN = 0;
    SERVING = 1;
    NOT_SERVING = 2;
  }
  ServingStatus status = 1;
  string message = 2;
  int64 timestamp = 3;
}

message ApiItem {
  string index = 1;
  string name = 2;
  string url = 3;
  string endpoint = 4;
}

message SearchResult {
  ApiItem item = 1;
  string matched_field = 2;
  float relevance_score = 3;
}


